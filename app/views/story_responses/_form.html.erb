<div class="card shadow mt-5">
  <div class="card-body">
    <% if story.story_responses.present? %>
      <ul class="list-unstyled" id="response-listing">
        <% User.joins(:story_responses).uniq.reverse.each do |user| %>
          <% responses = user.story_responses.where(story_id: @story.id) %>
          <%= render 'story_responses/response_with_count', responses: responses, user: user %>
        <% end %>
      </ul>
    <% end %>
    <p>Let <span class="font-weight-bold text-primary"><%= story.user.name %></span> know that you are ready to help. Write in the below textarea how you can help.</p>
    <%= form_for [story, story.story_responses.build], html: { remote: true } do |f| %>
      <div id="response_error_area"></div>
      <%= f.hidden_field :user_id, value: current_user.id %>
      <%= f.text_area :body, class: "form-control form-control-lg", rows: "5", required: true %>  
      <%= f.submit 'Submit', class: 'btn btn-primary btn-lg mt-3' %>
    <% end %>
  </div>
</div>
